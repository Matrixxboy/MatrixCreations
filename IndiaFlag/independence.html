<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Independence Day!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Inter', sans-serif;
            background-color: #0a192f; /* A deep navy blue for a night sky effect */
        }
        #info {
            position: absolute;
            top: 0;
            width: 100%;
            text-align: center;
            padding: 20px;
            color: white;
            z-index: 100;
            pointer-events: none;
        }
        #message-container {
            position: absolute;
            bottom: 5%;
            width: 100%;
            text-align: center;
            color: #e2e8f0;
            font-size: 1.25rem;
            text-shadow: 0 0 10px rgba(0,0,0,0.7);
            z-index: 100;
            pointer-events: none;
            transition: opacity 1s ease-in-out;
        }
        #credit {
            position: absolute;
            bottom: 10px;
            right: 10px;
            color: #a0aec0;
            font-size: 0.8rem;
            z-index: 100;
            pointer-events: none;
        }
        #container {
            width: 100vw;
            height: 100vh;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="info" class="select-none">
        <h1 class="text-3xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-orange-400 via-white to-green-400">
            Happy Independence Day!
        </h1>
        <p class="text-gray-300 mt-2">Drag to rotate the flag</p>
    </div>
    
    <div id="message-container"></div>

    <div id="credit">Created by Utsav Lankapati</div>

    <div id="container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <script>
        // Scene setup
        let scene, camera, renderer, controls, clock;
        let flagMesh, particleSystem;
        const FLAG_WIDTH = 6;
        const FLAG_HEIGHT = 4;
        const WAVE_SPEED = 2.5;
        const WAVE_AMPLITUDE = 0.3;
        const WAVE_FREQUENCY = 2.0;

        function init() {
            // Scene
            scene = new THREE.Scene();
            clock = new THREE.Clock();

            // Camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 7;

            // Renderer
            const container = document.getElementById('container');
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            container.appendChild(renderer.domElement);
            
            // Lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.7);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(5, 5, 5);
            scene.add(directionalLight);

            // Create the flag texture
            const flagTexture = createFlagTexture();

            // Create the flag geometry
            const flagGeometry = new THREE.PlaneGeometry(FLAG_WIDTH, FLAG_HEIGHT, 50, 30);
            const flagMaterial = new THREE.MeshPhongMaterial({
                map: flagTexture,
                side: THREE.DoubleSide,
                shininess: 30
            });
            flagMesh = new THREE.Mesh(flagGeometry, flagMaterial);
            scene.add(flagMesh);

            // Create particle system
            createParticles();

            // Controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.minDistance = 3;
            controls.maxDistance = 30;

            // Handle window resize
            window.addEventListener('resize', onWindowResize, false);
            
            // Start message cycle
            startMessageCycle();
            
            // Start animation
            animate();
        }

        function createFlagTexture() {
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            const width = 512;
            const height = width * (2/3); // Aspect ratio of Indian flag is 2:3
            canvas.width = width;
            canvas.height = height;

            const stripeHeight = height / 3;

            // Saffron stripe
            context.fillStyle = '#FF9933';
            context.fillRect(0, 0, width, stripeHeight);

            // White stripe
            context.fillStyle = '#FFFFFF';
            context.fillRect(0, stripeHeight, width, stripeHeight);

            // Green stripe
            context.fillStyle = '#138808';
            context.fillRect(0, stripeHeight * 2, width, stripeHeight);

            // Ashoka Chakra
            const chakraRadius = stripeHeight * 0.4;
            const centerX = width / 2;
            const centerY = height / 2;

            context.strokeStyle = '#000080'; // Navy Blue
            context.lineWidth = 5;

            // Outer circle
            context.beginPath();
            context.arc(centerX, centerY, chakraRadius, 0, 2 * Math.PI, false);
            context.stroke();

            // 24 spokes
            for (let i = 0; i < 24; i++) {
                const angle = (i * 2 * Math.PI) / 24;
                const x1 = centerX;
                const y1 = centerY;
                const x2 = centerX + chakraRadius * Math.cos(angle);
                const y2 = centerY + chakraRadius * Math.sin(angle);
                context.beginPath();
                context.moveTo(x1, y1);
                context.lineTo(x2, y2);
                context.stroke();
            }

            return new THREE.CanvasTexture(canvas);
        }

        function createParticles() {
            const particles = 5000;
            const geometry = new THREE.BufferGeometry();
            const positions = [];
            const colors = [];

            const flagColors = [
                new THREE.Color('#FF9933'), // Saffron
                new THREE.Color('#FFFFFF'), // White
                new THREE.Color('#138808')  // Green
            ];

            for (let i = 0; i < particles; i++) {
                positions.push((Math.random() - 0.5) * 50); // x
                positions.push((Math.random() - 0.5) * 50); // y
                positions.push((Math.random() - 0.5) * 50); // z

                const color = flagColors[Math.floor(Math.random() * flagColors.length)];
                colors.push(color.r, color.g, color.b);
            }

            geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));

            const material = new THREE.PointsMaterial({
                size: 0.1,
                vertexColors: true,
                transparent: true,
                opacity: 0.8
            });

            particleSystem = new THREE.Points(geometry, material);
            scene.add(particleSystem);
        }

        function startMessageCycle() {
            const messages = [
                "Freedom in the mind, Faith in the words, Pride in our souls.",
                "Let's salute the martyrs for the sacrifices they made.",
                "Wishing you a day filled with patriotic spirit and pride.",
                "Unity in diversity, the strength of our nation.",
                "Jai Hind! Vande Mataram!"
            ];
            let messageIndex = 0;
            const messageElement = document.getElementById('message-container');

            function displayNextMessage() {
                messageElement.style.opacity = 0;
                setTimeout(() => {
                    messageIndex = (messageIndex + 1) % messages.length;
                    messageElement.innerText = messages[messageIndex];
                    messageElement.style.opacity = 1;
                }, 1000); // Wait for fade out
            }

            // Initial message
            messageElement.innerText = messages[messageIndex];
            messageElement.style.opacity = 1;

            setInterval(displayNextMessage, 5000); // Change message every 5 seconds
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);

            const elapsedTime = clock.getElapsedTime();
            const vertices = flagMesh.geometry.attributes.position;

            // Animate the flag to make it wave
            for (let i = 0; i < vertices.count; i++) {
                const x = vertices.getX(i);
                const waveX = Math.sin(x * WAVE_FREQUENCY + elapsedTime * WAVE_SPEED) * WAVE_AMPLITUDE;
                vertices.setZ(i, waveX);
            }
            vertices.needsUpdate = true;
            
            // Animate particles
            if(particleSystem) {
                particleSystem.rotation.y = elapsedTime * 0.05;
            }

            controls.update();
            renderer.render(scene, camera);
        }

        init();
    </script>
</body>
</html>
